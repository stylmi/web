{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"/Users/mrcea/Desktop/Nunua/template/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/mrcea/Desktop/Nunua/template/packages/web/pages/nearest-posts.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useState } from 'react';\nimport Link from 'next/link';\nimport { Grid } from 'react-styled-flexboxgrid';\nimport { useQuery } from '@apollo/react-hooks';\nimport { GET_NEAREST_POST } from 'core/graphql/NearestPost.query';\nimport { CURRENCY } from '../Config';\nimport { SINGLE_POST_PAGE } from 'core/navigation/constant';\nimport withLayout from '../hoc/withLayout';\nimport PageMeta from '../components/PageMeta';\nimport Heading from 'reusecore/src/elements/Heading';\nimport Box from 'reusecore/src/elements/Box';\nimport ListGrid from 'reusecore/src/elements/ListGrid';\nimport CardLoader from '../components/Loader/CardLoader';\nimport PostCard from '../components/PostCard';\nimport NoItemFound from '../components/NoItemFound';\nimport OnError from '../components/OnError';\nimport { withApollo } from '../helpers/apollo';\nexport default _c3 = withApollo(_c2 = withLayout(_c = _s(function (_ref) {\n  _s();\n\n  var location = _ref.location;\n\n  var _useState = useState(false),\n      loadingMore = _useState[0],\n      toggleLoading = _useState[1];\n\n  var _useState2 = useState(1),\n      page = _useState2[0],\n      paginate = _useState2[1];\n\n  var QUERY_VARIABLES = {\n    page: 1,\n    LIMIT: 4,\n    location: location\n  };\n\n  var _useQuery = useQuery(GET_NEAREST_POST, {\n    variables: QUERY_VARIABLES\n  }),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      fetchMore = _useQuery.fetchMore;\n\n  if (error) return /*#__PURE__*/_jsxDEV(OnError, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 32,\n    columnNumber: 23\n  }, _this);\n  var postCount = data && data.nearest && data.nearest.data ? data.nearest.data.length : 1;\n  var nearest = data && data.nearest && data.nearest.data ? data.nearest.data : [];\n  var totalPost = data && data.nearest ? data.nearest.total : 1;\n\n  var renderNearestPost = function renderNearestPost(item) {\n    var title = item.title,\n        slug = item.slug,\n        _item$price = item.price,\n        price = _item$price === void 0 ? 0.0 : _item$price,\n        _item$image = item.image,\n        url = _item$image.url,\n        largeUrl = _item$image.largeUrl;\n    return /*#__PURE__*/_jsxDEV(Link, {\n      href: \"\".concat(SINGLE_POST_PAGE, \"/\").concat(slug),\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        children: /*#__PURE__*/_jsxDEV(PostCard, {\n          currency: CURRENCY,\n          title: title,\n          price: price,\n          imageSrc: [url, largeUrl]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 9\n    }, _this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(PageMeta, {\n      title: \"Recent Post\",\n      description: \"Recent Post\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, _this), /*#__PURE__*/_jsxDEV(Box, {\n      mt: 50,\n      mb: 50,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        children: [/*#__PURE__*/_jsxDEV(Heading, {\n          content: \"Nearest Post\",\n          mb: 40,\n          style: {\n            fontSize: 24,\n            fontWeight: 600,\n            color: '#333333'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, _this), !loading && !nearest.length ? /*#__PURE__*/_jsxDEV(NoItemFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 15\n        }, _this) : /*#__PURE__*/_jsxDEV(ListGrid, {\n          data: nearest,\n          totalPost: totalPost,\n          postCount: postCount,\n          columnWidth: [1, 1 / 2, 1 / 4],\n          component: renderNearestPost,\n          loading: loading ? loading : loadingMore,\n          isLoading: loadingMore,\n          placeholder: /*#__PURE__*/_jsxDEV(CardLoader, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 30\n          }, _this),\n          limit: QUERY_VARIABLES.LIMIT,\n          handleLoadMore: function handleLoadMore(loading) {\n            toggleLoading(true);\n            paginate(page + 1);\n            fetchMore({\n              variables: {\n                page: page + 1\n              },\n              updateQuery: function updateQuery(prev, _ref2) {\n                var fetchMoreResult = _ref2.fetchMoreResult;\n\n                if (!fetchMoreResult) {\n                  toggleLoading(false);\n                  return prev;\n                }\n\n                if (postCount && totalPost) {\n                  if (postCount <= totalPost) {\n                    toggleLoading(false);\n                    return Object.assign({}, prev, {\n                      nearest: {\n                        data: [].concat(_toConsumableArray(prev.nearest.data), _toConsumableArray(fetchMoreResult.nearest.data)),\n                        total: totalPost\n                      }\n                    });\n                  }\n                }\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 15\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true);\n}, \"rGadjvRkkFk17R26hi68/KEVYuw=\", false, function () {\n  return [useQuery];\n})));\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"%default%$withApollo$withLayout\");\n$RefreshReg$(_c2, \"%default%$withApollo\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["/Users/mrcea/Desktop/Nunua/template/packages/web/pages/nearest-posts.js"],"names":["useState","Link","Grid","useQuery","GET_NEAREST_POST","CURRENCY","SINGLE_POST_PAGE","withLayout","PageMeta","Heading","Box","ListGrid","CardLoader","PostCard","NoItemFound","OnError","withApollo","location","loadingMore","toggleLoading","page","paginate","QUERY_VARIABLES","LIMIT","variables","data","loading","error","fetchMore","postCount","nearest","length","totalPost","total","renderNearestPost","item","title","slug","price","image","url","largeUrl","fontSize","fontWeight","color","updateQuery","prev","fetchMoreResult","Object","assign"],"mappings":"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","sourcesContent":["import { useState } from 'react';\nimport Link from 'next/link';\nimport { Grid } from 'react-styled-flexboxgrid';\nimport { useQuery } from '@apollo/react-hooks';\nimport { GET_NEAREST_POST } from 'core/graphql/NearestPost.query';\nimport { CURRENCY } from '../Config';\nimport { SINGLE_POST_PAGE } from 'core/navigation/constant';\nimport withLayout from '../hoc/withLayout';\nimport PageMeta from '../components/PageMeta';\n\nimport Heading from 'reusecore/src/elements/Heading';\nimport Box from 'reusecore/src/elements/Box';\nimport ListGrid from 'reusecore/src/elements/ListGrid';\nimport CardLoader from '../components/Loader/CardLoader';\nimport PostCard from '../components/PostCard';\nimport NoItemFound from '../components/NoItemFound';\nimport OnError from '../components/OnError';\nimport { withApollo } from '../helpers/apollo';\nexport default withApollo(\n  withLayout(({ location }) => {\n    const [loadingMore, toggleLoading] = useState(false);\n    const [page, paginate] = useState(1);\n    let QUERY_VARIABLES = {\n      page: 1,\n      LIMIT: 4,\n      location,\n    };\n    const { data, loading, error, fetchMore } = useQuery(GET_NEAREST_POST, {\n      variables: QUERY_VARIABLES,\n    });\n\n    if (error) return <OnError />;\n\n    const postCount =\n      data && data.nearest && data.nearest.data ? data.nearest.data.length : 1;\n    const nearest =\n      data && data.nearest && data.nearest.data ? data.nearest.data : [];\n    const totalPost = data && data.nearest ? data.nearest.total : 1;\n\n    const renderNearestPost = item => {\n      const {\n        title,\n        slug,\n        price = 0.0,\n        image: { url, largeUrl },\n      } = item;\n      return (\n        <Link href={`${SINGLE_POST_PAGE}/${slug}`}>\n          <a>\n            <PostCard\n              currency={CURRENCY}\n              title={title}\n              price={price}\n              imageSrc={[url, largeUrl]}\n            />\n          </a>\n        </Link>\n      );\n    };\n\n    return (\n      <>\n        <PageMeta title=\"Recent Post\" description=\"Recent Post\" />\n        <Box mt={50} mb={50}>\n          <Grid>\n            <Heading\n              content=\"Nearest Post\"\n              mb={40}\n              style={{ fontSize: 24, fontWeight: 600, color: '#333333' }}\n            />\n            {!loading && !nearest.length ? (\n              <NoItemFound />\n            ) : (\n              <ListGrid\n                data={nearest}\n                totalPost={totalPost}\n                postCount={postCount}\n                columnWidth={[1, 1 / 2, 1 / 4]}\n                component={renderNearestPost}\n                loading={loading ? loading : loadingMore}\n                isLoading={loadingMore}\n                placeholder={<CardLoader />}\n                limit={QUERY_VARIABLES.LIMIT}\n                handleLoadMore={loading => {\n                  toggleLoading(true);\n                  paginate(page + 1);\n                  fetchMore({\n                    variables: {\n                      page: page + 1,\n                    },\n                    updateQuery: (prev, { fetchMoreResult }) => {\n                      if (!fetchMoreResult) {\n                        toggleLoading(false);\n                        return prev;\n                      }\n                      if (postCount && totalPost) {\n                        if (postCount <= totalPost) {\n                          toggleLoading(false);\n                          return Object.assign({}, prev, {\n                            nearest: {\n                              data: [\n                                ...prev.nearest.data,\n                                ...fetchMoreResult.nearest.data,\n                              ],\n                              total: totalPost,\n                            },\n                          });\n                        }\n                      }\n                    },\n                  });\n                }}\n              />\n            )}\n          </Grid>\n        </Box>\n      </>\n    );\n  })\n);\n"]},"metadata":{},"sourceType":"module"}