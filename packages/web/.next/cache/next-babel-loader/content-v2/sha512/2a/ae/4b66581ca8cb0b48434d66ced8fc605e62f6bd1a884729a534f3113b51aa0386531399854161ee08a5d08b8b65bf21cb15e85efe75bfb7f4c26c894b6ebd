{"ast":null,"code":"import _objectWithoutProperties from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\olaji\\\\OneDrive\\\\Documents\\\\sellit\\\\template\\\\packages\\\\web\\\\containers\\\\AddPost\\\\CategoryAndDetailInfo\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport Icon from 'react-icons-kit';\nimport { archive } from 'react-icons-kit/ionicons/archive';\nimport { chevronRight } from 'react-icons-kit/ionicons/chevronRight';\nimport { uploadMultipleImages } from '../../../helpers/uploadMultipleImage';\nimport Box from '../../../../reusecore/src/elements/Box';\nimport Button from '../../../../reusecore/src/elements/Button';\nimport { chevronLeft } from 'react-icons-kit/ionicons/chevronLeft';\nimport Text from '../../../../reusecore/src/elements/Text';\nimport Input from '../../../components/Input';\nimport { ADD_POST } from '../../../../core/graphql/Mutations';\nimport AsyncSelect from 'react-select/async';\nimport { AddPostContext } from '../../../contexts/AddPostContext';\nimport { useQuery, useMutation } from '@apollo/react-hooks';\nimport AuthHelper from '../../../helpers/authHelper';\nimport { GET_CATEGORIES_FOR_DROPDOWN } from '../../../../core/graphql/Category.query';\nvar colourStyles = {\n  control: function control() {\n    return {\n      display: 'flex',\n      backgroundColor: 'transparent',\n      color: '#8c8c8c',\n      border: '0',\n      borderBottom: '1px solid #e2e2e2'\n    };\n  },\n  valueContainer: function valueContainer(base) {\n    return _objectSpread(_objectSpread({}, base), {}, {\n      padding: '0'\n    });\n  },\n  placeholder: function placeholder() {\n    return {\n      color: '#8c8c8c'\n    };\n  },\n  indicatorSeparator: function indicatorSeparator() {\n    return {\n      display: 'none'\n    };\n  },\n  input: function input() {\n    return {\n      color: '#8c8c8c'\n    };\n  },\n  dropdownIndicator: function dropdownIndicator() {\n    return {\n      padding: '8px 0'\n    };\n  }\n};\nvar imagesUrl = [];\n\nvar CategoryAndDetailInfo = function CategoryAndDetailInfo(props) {\n  _s();\n\n  var _useContext = useContext(AddPostContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var _useState = useState(false),\n      btnLoading = _useState[0],\n      setBtnLoading = _useState[1];\n\n  var _useMutation = useMutation(ADD_POST),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      postMutation = _useMutation2[0];\n\n  var _useQuery = useQuery(GET_CATEGORIES_FOR_DROPDOWN, {\n    variables: {\n      limit: 1000\n    }\n  }),\n      data = _useQuery.data,\n      error = _useQuery.error,\n      loading = _useQuery.loading,\n      fetchMore = _useQuery.fetchMore;\n\n  var step = state.step,\n      adPost = state.adPost;\n  var options = [];\n\n  if (!loading && data.categories.data.length) {\n    data.categories.data.map(function (item, index) {\n      var categoryOptions = _objectSpread(_objectSpread({}, item), {}, {\n        value: item.id,\n        label: item.name\n      });\n\n      options.push(categoryOptions);\n    });\n  }\n\n  var handleDraftingPost = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return AuthHelper.refreshToken();\n\n            case 2:\n              setBtnLoading(true);\n\n              if (!adPost.localGallery.length) {\n                _context.next = 10;\n                break;\n              }\n\n              _context.next = 6;\n              return uploadMultipleImages(adPost.localGallery);\n\n            case 6:\n              imagesUrl = _context.sent;\n\n              if (imagesUrl && imagesUrl.length > 0) {\n                dispatch({\n                  type: 'UPDATE_FULL_ADPOST',\n                  payload: {\n                    gallery: adPost.gallery.concat(imagesUrl[0]),\n                    image: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\n                    localImage: {},\n                    localGallery: []\n                  }\n                });\n              }\n\n              _context.next = 21;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.next = 13;\n              return postMutation({\n                variables: {\n                  post: finalData\n                }\n              });\n\n            case 13:\n              _data = _context.sent;\n              setBtnLoading(false);\n\n              if (!adPost.id) {\n                dispatch({\n                  type: 'UPDATE_ADPOST',\n                  payload: {\n                    key: 'id',\n                    value: _data.data.addPost.id\n                  }\n                });\n              }\n\n              _context.next = 21;\n              break;\n\n            case 18:\n              _context.prev = 18;\n              _context.t0 = _context[\"catch\"](10);\n              setBtnLoading(false);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[10, 18]]);\n    }));\n\n    return function handleDraftingPost() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var preImage = adPost.preImage,\n      preGallery = adPost.preGallery,\n      localImage = adPost.localImage,\n      localGallery = adPost.localGallery,\n      location = adPost.location,\n      prossedAdPostData = _objectWithoutProperties(adPost, [\"preImage\", \"preGallery\", \"localImage\", \"localGallery\", \"location\"]);\n\n  var finalData = prossedAdPostData;\n\n  if (location && location.lat) {\n    finalData = _objectSpread(_objectSpread({}, prossedAdPostData), {}, {\n      location: location\n    });\n  }\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _data2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!imagesUrl.length) {\n                _context2.next = 12;\n                break;\n              }\n\n              _context2.prev = 1;\n              _context2.next = 4;\n              return postMutation({\n                variables: {\n                  post: finalData\n                }\n              });\n\n            case 4:\n              _data2 = _context2.sent;\n              setBtnLoading(false);\n\n              if (!adPost.id) {\n                dispatch({\n                  type: 'UPDATE_ADPOST',\n                  payload: {\n                    key: 'id',\n                    value: _data2.data.addPost.id\n                  }\n                });\n              }\n\n              _context2.next = 12;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](1);\n              setBtnLoading(false);\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 9]]);\n    }))();\n  }, [prossedAdPostData.gallery]);\n\n  var _loadOptions = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(fetchMore, inputValue, callback, loading) {\n      var filteredData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              filteredData = options.filter(function (item) {\n                return item.slug.includes(inputValue);\n              });\n              callback(filteredData);\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function loadOptions(_x, _x2, _x3, _x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Text, {\n    content: \"Select the preferred categories\",\n    pb: 20,\n    style: {\n      fontSize: 16,\n      fontWeight: 400,\n      color: '#595959'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }), __jsx(AsyncSelect, {\n    isMulti: true,\n    defaultValue: adPost.categories ? adPost.categories : [],\n    defaultOptions: options,\n    styles: colourStyles,\n    loadOptions: function loadOptions(inputValue, callback) {\n      return _loadOptions(fetchMore, inputValue, callback, loading);\n    },\n    onChange: function onChange(selectedCategories) {\n      dispatch({\n        type: 'UPDATE_ADPOST',\n        payload: {\n          key: 'categories',\n          value: selectedCategories\n        }\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }), __jsx(Input, {\n    elementType: \"textarea\",\n    rows: 4,\n    elementConfig: {\n      type: 'text',\n      required: 'required'\n    },\n    label: \"Details\",\n    changed: function changed(details) {\n      return dispatch({\n        type: 'UPDATE_ADPOST',\n        payload: {\n          key: 'content',\n          value: details.target.value\n        }\n      });\n    },\n    value: adPost.content,\n    style: {\n      marginTop: 40\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }), __jsx(Box, {\n    flexBox: true,\n    justifyContent: \"space-between\",\n    mt: 40,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    title: \"Save\",\n    iconPosition: \"left\",\n    icon: __jsx(Icon, {\n      icon: archive,\n      size: 18,\n      color: \"#8C8C8C\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }\n    }),\n    onClick: handleDraftingPost,\n    variant: \"textButton\",\n    isLoading: btnLoading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    title: \"Previous\",\n    iconPosition: \"left\",\n    onClick: function onClick() {\n      return dispatch({\n        type: 'UPDATE_STEP',\n        payload: {\n          step: step - 1\n        }\n      });\n    },\n    disabled: btnLoading,\n    icon: __jsx(Icon, {\n      icon: chevronLeft,\n      size: 14,\n      color: \"#8C8C8C\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 17\n      }\n    }),\n    variant: \"textButton\",\n    mr: 30,\n    ml: \"auto\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    title: \"Next\",\n    iconPosition: \"right\",\n    disabled: adPost.categories.length === 0 || btnLoading,\n    onClick: function onClick() {\n      return dispatch({\n        type: 'UPDATE_STEP',\n        payload: {\n          step: step + 1\n        }\n      });\n    },\n    icon: __jsx(Icon, {\n      icon: chevronRight,\n      size: 21,\n      color: \"#ffffff\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }\n    }),\n    style: {\n      backgroundColor: adPost.categories.length === 0 || btnLoading ? '#e2e2e2' : '#30C56D'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  })));\n};\n\n_s(CategoryAndDetailInfo, \"LEMTGkG8GuJMfFr9nhWaafi2e5Y=\", false, function () {\n  return [useMutation, useQuery];\n});\n\n_c = CategoryAndDetailInfo;\nexport default CategoryAndDetailInfo;\n\nvar _c;\n\n$RefreshReg$(_c, \"CategoryAndDetailInfo\");","map":{"version":3,"sources":["C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/containers/AddPost/CategoryAndDetailInfo/index.js"],"names":["React","useState","useContext","useEffect","Icon","archive","chevronRight","uploadMultipleImages","Box","Button","chevronLeft","Text","Input","ADD_POST","AsyncSelect","AddPostContext","useQuery","useMutation","AuthHelper","GET_CATEGORIES_FOR_DROPDOWN","colourStyles","control","display","backgroundColor","color","border","borderBottom","valueContainer","base","padding","placeholder","indicatorSeparator","input","dropdownIndicator","imagesUrl","CategoryAndDetailInfo","props","state","dispatch","btnLoading","setBtnLoading","postMutation","variables","limit","data","error","loading","fetchMore","step","adPost","options","categories","length","map","item","index","categoryOptions","value","id","label","name","push","handleDraftingPost","refreshToken","localGallery","type","payload","gallery","concat","image","url","localImage","post","finalData","key","addPost","preImage","preGallery","location","prossedAdPostData","lat","loadOptions","inputValue","callback","filteredData","filter","slug","includes","fontSize","fontWeight","selectedCategories","required","details","target","content","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport Icon from 'react-icons-kit';\r\nimport { archive } from 'react-icons-kit/ionicons/archive';\r\nimport { chevronRight } from 'react-icons-kit/ionicons/chevronRight';\r\nimport { uploadMultipleImages } from '../../../helpers/uploadMultipleImage';\r\nimport Box from '../../../../reusecore/src/elements/Box';\r\nimport Button from '../../../../reusecore/src/elements/Button';\r\nimport { chevronLeft } from 'react-icons-kit/ionicons/chevronLeft';\r\nimport Text from '../../../../reusecore/src/elements/Text';\r\nimport Input from '../../../components/Input';\r\nimport { ADD_POST } from '../../../../core/graphql/Mutations';\r\nimport AsyncSelect from 'react-select/async';\r\nimport { AddPostContext } from '../../../contexts/AddPostContext';\r\nimport { useQuery, useMutation } from '@apollo/react-hooks';\r\nimport AuthHelper from '../../../helpers/authHelper';\r\nimport { GET_CATEGORIES_FOR_DROPDOWN } from '../../../../core/graphql/Category.query';\r\n\r\nconst colourStyles = {\r\n  control: () => ({\r\n    display: 'flex',\r\n    backgroundColor: 'transparent',\r\n    color: '#8c8c8c',\r\n    border: '0',\r\n    borderBottom: '1px solid #e2e2e2',\r\n  }),\r\n  valueContainer: base => ({\r\n    ...base,\r\n    padding: '0',\r\n  }),\r\n  placeholder: () => ({\r\n    color: '#8c8c8c',\r\n  }),\r\n  indicatorSeparator: () => ({\r\n    display: 'none',\r\n  }),\r\n  input: () => ({\r\n    color: '#8c8c8c',\r\n  }),\r\n  dropdownIndicator: () => ({\r\n    padding: '8px 0',\r\n  }),\r\n};\r\n\r\nlet imagesUrl = [];\r\nconst CategoryAndDetailInfo = props => {\r\n  const { state, dispatch } = useContext(AddPostContext);\r\n  const [btnLoading, setBtnLoading] = useState(false);\r\n  const [postMutation] = useMutation(ADD_POST);\r\n  const { data, error, loading, fetchMore } = useQuery(\r\n    GET_CATEGORIES_FOR_DROPDOWN,\r\n    {\r\n      variables: {\r\n        limit: 1000,\r\n      },\r\n    }\r\n  );\r\n  const { step, adPost } = state;\r\n  let options = [];\r\n  if (!loading && data.categories.data.length) {\r\n    data.categories.data.map((item, index) => {\r\n      let categoryOptions = { ...item, value: item.id, label: item.name };\r\n      options.push(categoryOptions);\r\n    });\r\n  }\r\n\r\n  const handleDraftingPost = async () => {\r\n    await AuthHelper.refreshToken();\r\n    setBtnLoading(true);\r\n    if (adPost.localGallery.length) {\r\n      imagesUrl = await uploadMultipleImages(adPost.localGallery);\r\n      if (imagesUrl && imagesUrl.length > 0) {\r\n        dispatch({\r\n          type: 'UPDATE_FULL_ADPOST',\r\n          payload: {\r\n            gallery: adPost.gallery.concat(imagesUrl[0]),\r\n            image: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\r\n            localImage: {},\r\n            localGallery: [],\r\n          },\r\n        });\r\n      }\r\n    } else {\r\n      try {\r\n        const data = await postMutation({\r\n          variables: {\r\n            post: finalData,\r\n          },\r\n        });\r\n        setBtnLoading(false);\r\n        if (!adPost.id) {\r\n          dispatch({\r\n            type: 'UPDATE_ADPOST',\r\n            payload: { key: 'id', value: data.data.addPost.id },\r\n          });\r\n        }\r\n      } catch (error) {\r\n        setBtnLoading(false);\r\n      }\r\n    }\r\n  };\r\n  const {\r\n    preImage,\r\n    preGallery,\r\n    localImage,\r\n    localGallery,\r\n    location,\r\n    ...prossedAdPostData\r\n  } = adPost;\r\n  let finalData = prossedAdPostData;\r\n  if (location && location.lat) {\r\n    finalData = {\r\n      ...prossedAdPostData,\r\n      location,\r\n    };\r\n  }\r\n\r\n  useEffect(() => {\r\n    (async function() {\r\n      if (imagesUrl.length) {\r\n        try {\r\n          const data = await postMutation({\r\n            variables: {\r\n              post: finalData,\r\n            },\r\n          });\r\n          setBtnLoading(false);\r\n          if (!adPost.id) {\r\n            dispatch({\r\n              type: 'UPDATE_ADPOST',\r\n              payload: { key: 'id', value: data.data.addPost.id },\r\n            });\r\n          }\r\n        } catch (error) {\r\n          setBtnLoading(false);\r\n        }\r\n      }\r\n    })();\r\n  }, [prossedAdPostData.gallery]);\r\n\r\n  const loadOptions = async (fetchMore, inputValue, callback, loading) => {\r\n    const filteredData = options.filter(item => item.slug.includes(inputValue));\r\n    callback(filteredData);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Text\r\n        content=\"Select the preferred categories\"\r\n        pb={20}\r\n        style={{ fontSize: 16, fontWeight: 400, color: '#595959' }}\r\n      />\r\n      <AsyncSelect\r\n        isMulti={true}\r\n        defaultValue={adPost.categories ? adPost.categories : []}\r\n        defaultOptions={options}\r\n        styles={colourStyles}\r\n        loadOptions={(inputValue, callback) =>\r\n          loadOptions(fetchMore, inputValue, callback, loading)\r\n        }\r\n        onChange={selectedCategories => {\r\n          dispatch({\r\n            type: 'UPDATE_ADPOST',\r\n            payload: {\r\n              key: 'categories',\r\n              value: selectedCategories,\r\n            },\r\n          });\r\n        }}\r\n      />\r\n      <Input\r\n        elementType=\"textarea\"\r\n        rows={4}\r\n        elementConfig={{\r\n          type: 'text',\r\n          required: 'required',\r\n        }}\r\n        label=\"Details\"\r\n        changed={details =>\r\n          dispatch({\r\n            type: 'UPDATE_ADPOST',\r\n            payload: { key: 'content', value: details.target.value },\r\n          })\r\n        }\r\n        value={adPost.content}\r\n        style={{\r\n          marginTop: 40,\r\n        }}\r\n      />\r\n\r\n      <Box flexBox justifyContent=\"space-between\" mt={40}>\r\n        <Button\r\n          title=\"Save\"\r\n          iconPosition=\"left\"\r\n          icon={<Icon icon={archive} size={18} color=\"#8C8C8C\" />}\r\n          onClick={handleDraftingPost}\r\n          variant=\"textButton\"\r\n          isLoading={btnLoading}\r\n        />\r\n        <Button\r\n          title=\"Previous\"\r\n          iconPosition=\"left\"\r\n          onClick={() =>\r\n            dispatch({\r\n              type: 'UPDATE_STEP',\r\n              payload: { step: step - 1 },\r\n            })\r\n          }\r\n          disabled={btnLoading}\r\n          icon={<Icon icon={chevronLeft} size={14} color=\"#8C8C8C\" />}\r\n          variant=\"textButton\"\r\n          mr={30}\r\n          ml=\"auto\"\r\n        />\r\n        <Button\r\n          title=\"Next\"\r\n          iconPosition=\"right\"\r\n          disabled={adPost.categories.length === 0 || btnLoading}\r\n          onClick={() =>\r\n            dispatch({\r\n              type: 'UPDATE_STEP',\r\n              payload: { step: step + 1 },\r\n            })\r\n          }\r\n          icon={<Icon icon={chevronRight} size={21} color=\"#ffffff\" />}\r\n          style={{\r\n            backgroundColor:\r\n              adPost.categories.length === 0 || btnLoading\r\n                ? '#e2e2e2'\r\n                : '#30C56D',\r\n          }}\r\n        />\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CategoryAndDetailInfo;\r\n"]},"metadata":{},"sourceType":"module"}