{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\olaji\\\\OneDrive\\\\Documents\\\\sellit\\\\template\\\\packages\\\\web\\\\containers\\\\AddPost\\\\LocationInfo\\\\index.js\";\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Icon from \"react-icons-kit\";\nimport { archive } from \"react-icons-kit/ionicons/archive\";\nimport { chevronRight } from \"react-icons-kit/ionicons/chevronRight\";\nimport { chevronLeft } from \"react-icons-kit/ionicons/chevronLeft\";\nimport { uploadMultipleImages } from \"../../../helpers/uploadMultipleImage\";\nimport Box from \"../../../../reusecore/src/elements/Box\";\nimport Button from \"../../../../reusecore/src/elements/Button\";\nimport Text from \"../../../../reusecore/src/elements/Text\";\nimport LocationSearchInput from \"../../../components/InputGooglePlace/altered\";\nimport { withGoogleMap, GoogleMap, Marker } from \"react-google-maps\";\nimport { ADD_POST } from \"../../../../core/graphql/Mutations\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport AuthHelper from \"../../../helpers/authHelper\";\nimport { AddPostContext } from \"../../../contexts/AddPostContext\";\nconst MapView = withGoogleMap(props => {\n  return /*#__PURE__*/_jsxDEV(GoogleMap, {\n    defaultZoom: 13,\n    center: {\n      lat: props.location.latitude,\n      lng: props.location.longitude\n    },\n    children: /*#__PURE__*/_jsxDEV(Marker, {\n      position: {\n        lat: props.location.latitude,\n        lng: props.location.longitude\n      },\n      draggable: true,\n      onDragEnd: props.markerDrag\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 19,\n    columnNumber: 3\n  }, this);\n});\nlet imagesUrl = [];\n\nconst LocationInfo = () => {\n  const {\n    state,\n    dispatch\n  } = useContext(AddPostContext);\n  const {\n    step,\n    adPost\n  } = state;\n  const {\n    0: btnLoading,\n    1: setBtnLoading\n  } = useState(false);\n  const [postMutation, {\n    data\n  }] = useMutation(ADD_POST);\n\n  const handleLocation = (latlng, selected) => {\n    let locationObject = {\n      lat: false,\n      lng: false,\n      formattedAddress: \"\"\n    };\n\n    const location = _objectSpread(_objectSpread({}, locationObject), {}, {\n      lat: latlng.lat,\n      lng: latlng.lng,\n      formattedAddress: selected\n    });\n\n    dispatch({\n      type: \"UPDATE_ADPOST\",\n      payload: {\n        key: \"location\",\n        value: location\n      }\n    });\n  };\n\n  const handleAddress = () => {};\n\n  const handleDraftingPost = async () => {\n    await AuthHelper.refreshToken();\n    setBtnLoading(true);\n\n    if (adPost.localGallery.length) {\n      imagesUrl = await uploadMultipleImages(adPost.localGallery);\n\n      if (imagesUrl && imagesUrl.length > 0) {\n        dispatch({\n          type: \"UPDATE_FULL_ADPOST\",\n          payload: {\n            gallery: adPost.gallery.concat(imagesUrl[0]),\n            image: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\n            localImage: {},\n            localGallery: []\n          }\n        });\n      }\n    } else {\n      try {\n        const data = await postMutation({\n          variables: {\n            post: finalData\n          }\n        });\n        setBtnLoading(false);\n\n        if (!adPost.id) {\n          dispatch({\n            type: \"UPDATE_ADPOST\",\n            payload: {\n              key: \"id\",\n              value: data.data.addPost.id\n            }\n          });\n        }\n      } catch (error) {\n        setBtnLoading(false);\n      }\n    }\n  };\n\n  const {\n    preImage,\n    preGallery,\n    localImage,\n    localGallery,\n    location\n  } = adPost,\n        prossedAdPostData = _objectWithoutProperties(adPost, [\"preImage\", \"preGallery\", \"localImage\", \"localGallery\", \"location\"]);\n\n  let finalData = prossedAdPostData;\n\n  if (location && location.lat) {\n    finalData = _objectSpread(_objectSpread({}, prossedAdPostData), {}, {\n      location\n    });\n  }\n\n  useEffect(() => {\n    (async function () {\n      if (imagesUrl.length) {\n        try {\n          const data = await postMutation({\n            variables: {\n              post: finalData\n            }\n          });\n          setBtnLoading(false);\n\n          if (!adPost.id) {\n            dispatch({\n              type: \"UPDATE_ADPOST\",\n              payload: {\n                key: \"id\",\n                value: data.data.addPost.id\n              }\n            });\n          }\n        } catch (error) {\n          setBtnLoading(false);\n        }\n      }\n    })();\n  }, [prossedAdPostData.gallery]);\n  let latlng = {\n    latitude: 22.5104166,\n    longitude: 88.37109750000002\n  };\n\n  if (adPost.location != null) {\n    latlng = {\n      latitude: adPost.location.lat,\n      longitude: adPost.location.lng\n    };\n  }\n\n  const markerDrag = async marker => {\n    var geocoder = new google.maps.Geocoder();\n    latlng = {\n      lat: Number(marker.latLng.lat().toFixed(4)),\n      lng: Number(marker.latLng.lng().toFixed(4))\n    };\n    geocoder.geocode({\n      latLng: latlng\n    }, function (results, status) {\n      if (results[0] && results[0].formatted_address) {\n        const location = {\n          lat: latlng.lat,\n          lng: latlng.lng,\n          formattedAddress: results[0].formatted_address\n        };\n        dispatch({\n          type: \"UPDATE_ADPOST\",\n          payload: {\n            key: \"location\",\n            value: location\n          }\n        });\n      }\n    });\n  };\n\n  const handleChange = address => {\n    dispatch({\n      type: \"UPDATE_ADPOST\",\n      payload: {\n        key: \"location\",\n        value: _objectSpread(_objectSpread({}, adPost.location), {}, {\n          formattedAddress: address\n        })\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      content: \"Enter your location\",\n      pb: 20,\n      style: {\n        fontSize: 16,\n        fontWeight: 400,\n        color: \"#595959\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(LocationSearchInput, {\n      address: adPost.location && adPost.location.formattedAddress ? adPost.location.formattedAddress : \"\",\n      handleChange: handleChange,\n      handleAddress: handleAddress,\n      handleLocation: handleLocation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(MapView, {\n      containerElement: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: `195px`,\n          marginTop: \"8px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }, this),\n      mapElement: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: `100%`\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 17\n      }, this),\n      location: latlng,\n      markerDrag: marker => markerDrag(marker)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      flexBox: true,\n      justifyContent: \"space-between\",\n      mt: 40,\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        title: \"Save\",\n        iconPosition: \"left\",\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          icon: archive,\n          size: 18,\n          color: \"#8C8C8C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 12\n        }, this),\n        onClick: handleDraftingPost,\n        variant: \"textButton\",\n        isLoading: btnLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        title: \"Previous\",\n        iconPosition: \"left\",\n        onClick: () => dispatch({\n          type: \"UPDATE_STEP\",\n          payload: {\n            step: step - 1\n          }\n        }),\n        disabled: btnLoading,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          icon: chevronLeft,\n          size: 14,\n          color: \"#8C8C8C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 12\n        }, this),\n        variant: \"textButton\",\n        mr: 30,\n        ml: \"auto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        title: \"Next\",\n        iconPosition: \"right\",\n        disabled: adPost.location == null || btnLoading,\n        onClick: () => dispatch({\n          type: \"UPDATE_STEP\",\n          payload: {\n            step: step + 1\n          }\n        }),\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          icon: chevronRight,\n          size: 21,\n          color: \"#ffffff\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 12\n        }, this),\n        style: {\n          backgroundColor: adPost.location == null || btnLoading ? \"#e2e2e2\" : \"#30C56D\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\nexport default LocationInfo;","map":{"version":3,"sources":["C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/containers/AddPost/LocationInfo/index.js"],"names":["React","useState","useContext","useEffect","Icon","archive","chevronRight","chevronLeft","uploadMultipleImages","Box","Button","Text","LocationSearchInput","withGoogleMap","GoogleMap","Marker","ADD_POST","useMutation","AuthHelper","AddPostContext","MapView","props","lat","location","latitude","lng","longitude","markerDrag","imagesUrl","LocationInfo","state","dispatch","step","adPost","btnLoading","setBtnLoading","postMutation","data","handleLocation","latlng","selected","locationObject","formattedAddress","type","payload","key","value","handleAddress","handleDraftingPost","refreshToken","localGallery","length","gallery","concat","image","url","localImage","variables","post","finalData","id","addPost","error","preImage","preGallery","prossedAdPostData","marker","geocoder","google","maps","Geocoder","Number","latLng","toFixed","geocode","results","status","formatted_address","handleChange","address","fontSize","fontWeight","color","height","marginTop","backgroundColor"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\nimport Icon from \"react-icons-kit\";\r\nimport { archive } from \"react-icons-kit/ionicons/archive\";\r\nimport { chevronRight } from \"react-icons-kit/ionicons/chevronRight\";\r\nimport { chevronLeft } from \"react-icons-kit/ionicons/chevronLeft\";\r\nimport { uploadMultipleImages } from \"../../../helpers/uploadMultipleImage\";\r\nimport Box from \"../../../../reusecore/src/elements/Box\";\r\nimport Button from \"../../../../reusecore/src/elements/Button\";\r\nimport Text from \"../../../../reusecore/src/elements/Text\";\r\nimport LocationSearchInput from \"../../../components/InputGooglePlace/altered\";\r\nimport { withGoogleMap, GoogleMap, Marker } from \"react-google-maps\";\r\nimport { ADD_POST } from \"../../../../core/graphql/Mutations\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport AuthHelper from \"../../../helpers/authHelper\";\r\nimport { AddPostContext } from \"../../../contexts/AddPostContext\";\r\n\r\nconst MapView = withGoogleMap((props) => {\r\n\treturn (\r\n\t\t<GoogleMap\r\n\t\t\tdefaultZoom={13}\r\n\t\t\tcenter={{\r\n\t\t\t\tlat: props.location.latitude,\r\n\t\t\t\tlng: props.location.longitude,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Marker\r\n\t\t\t\tposition={{\r\n\t\t\t\t\tlat: props.location.latitude,\r\n\t\t\t\t\tlng: props.location.longitude,\r\n\t\t\t\t}}\r\n\t\t\t\tdraggable={true}\r\n\t\t\t\tonDragEnd={props.markerDrag}\r\n\t\t\t/>\r\n\t\t</GoogleMap>\r\n\t);\r\n});\r\n\r\nlet imagesUrl = [];\r\n\r\nconst LocationInfo = () => {\r\n\tconst { state, dispatch } = useContext(AddPostContext);\r\n\tconst { step, adPost } = state;\r\n\tconst [btnLoading, setBtnLoading] = useState(false);\r\n\tconst [postMutation, { data }] = useMutation(ADD_POST);\r\n\r\n\tconst handleLocation = (latlng, selected) => {\r\n\t\tlet locationObject = {\r\n\t\t\tlat: false,\r\n\t\t\tlng: false,\r\n\t\t\tformattedAddress: \"\",\r\n\t\t};\r\n\t\tconst location = {\r\n\t\t\t...locationObject,\r\n\t\t\tlat: latlng.lat,\r\n\t\t\tlng: latlng.lng,\r\n\t\t\tformattedAddress: selected,\r\n\t\t};\r\n\t\tdispatch({\r\n\t\t\ttype: \"UPDATE_ADPOST\",\r\n\t\t\tpayload: { key: \"location\", value: location },\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleAddress = () => {};\r\n\r\n\tconst handleDraftingPost = async () => {\r\n\t\tawait AuthHelper.refreshToken();\r\n\t\tsetBtnLoading(true);\r\n\t\tif (adPost.localGallery.length) {\r\n\t\t\timagesUrl = await uploadMultipleImages(adPost.localGallery);\r\n\t\t\tif (imagesUrl && imagesUrl.length > 0) {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"UPDATE_FULL_ADPOST\",\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tgallery: adPost.gallery.concat(imagesUrl[0]),\r\n\t\t\t\t\t\timage: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\r\n\t\t\t\t\t\tlocalImage: {},\r\n\t\t\t\t\t\tlocalGallery: [],\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tconst data = await postMutation({\r\n\t\t\t\t\tvariables: {\r\n\t\t\t\t\t\tpost: finalData,\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t\tsetBtnLoading(false);\r\n\t\t\t\tif (!adPost.id) {\r\n\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\ttype: \"UPDATE_ADPOST\",\r\n\t\t\t\t\t\tpayload: { key: \"id\", value: data.data.addPost.id },\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetBtnLoading(false);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst {\r\n\t\tpreImage,\r\n\t\tpreGallery,\r\n\t\tlocalImage,\r\n\t\tlocalGallery,\r\n\t\tlocation,\r\n\t\t...prossedAdPostData\r\n\t} = adPost;\r\n\tlet finalData = prossedAdPostData;\r\n\tif (location && location.lat) {\r\n\t\tfinalData = {\r\n\t\t\t...prossedAdPostData,\r\n\t\t\tlocation,\r\n\t\t};\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\t(async function() {\r\n\t\t\tif (imagesUrl.length) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst data = await postMutation({\r\n\t\t\t\t\t\tvariables: {\r\n\t\t\t\t\t\t\tpost: finalData,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetBtnLoading(false);\r\n\t\t\t\t\tif (!adPost.id) {\r\n\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\ttype: \"UPDATE_ADPOST\",\r\n\t\t\t\t\t\t\tpayload: { key: \"id\", value: data.data.addPost.id },\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tsetBtnLoading(false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})();\r\n\t}, [prossedAdPostData.gallery]);\r\n\r\n\tlet latlng = {\r\n\t\tlatitude: 22.5104166,\r\n\t\tlongitude: 88.37109750000002,\r\n\t};\r\n\r\n\tif (adPost.location != null) {\r\n\t\tlatlng = {\r\n\t\t\tlatitude: adPost.location.lat,\r\n\t\t\tlongitude: adPost.location.lng,\r\n\t\t};\r\n\t}\r\n\tconst markerDrag = async (marker) => {\r\n\t\tvar geocoder = new google.maps.Geocoder();\r\n\t\tlatlng = {\r\n\t\t\tlat: Number(marker.latLng.lat().toFixed(4)),\r\n\t\t\tlng: Number(marker.latLng.lng().toFixed(4)),\r\n\t\t};\r\n\t\tgeocoder.geocode({ latLng: latlng }, function(results, status) {\r\n\t\t\tif (results[0] && results[0].formatted_address) {\r\n\t\t\t\tconst location = {\r\n\t\t\t\t\tlat: latlng.lat,\r\n\t\t\t\t\tlng: latlng.lng,\r\n\t\t\t\t\tformattedAddress: results[0].formatted_address,\r\n\t\t\t\t};\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"UPDATE_ADPOST\",\r\n\t\t\t\t\tpayload: { key: \"location\", value: location },\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tconst handleChange = (address) => {\r\n\t\tdispatch({\r\n\t\t\ttype: \"UPDATE_ADPOST\",\r\n\t\t\tpayload: {\r\n\t\t\t\tkey: \"location\",\r\n\t\t\t\tvalue: { ...adPost.location, formattedAddress: address },\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Text\r\n\t\t\t\tcontent=\"Enter your location\"\r\n\t\t\t\tpb={20}\r\n\t\t\t\tstyle={{ fontSize: 16, fontWeight: 400, color: \"#595959\" }}\r\n\t\t\t/>\r\n\t\t\t<LocationSearchInput\r\n\t\t\t\taddress={\r\n\t\t\t\t\tadPost.location && adPost.location.formattedAddress\r\n\t\t\t\t\t\t? adPost.location.formattedAddress\r\n\t\t\t\t\t\t: \"\"\r\n\t\t\t\t}\r\n\t\t\t\thandleChange={handleChange}\r\n\t\t\t\thandleAddress={handleAddress}\r\n\t\t\t\thandleLocation={handleLocation}\r\n\t\t\t/>\r\n\t\t\t<MapView\r\n\t\t\t\tcontainerElement={<div style={{ height: `195px`, marginTop: \"8px\" }} />}\r\n\t\t\t\tmapElement={<div style={{ height: `100%` }} />}\r\n\t\t\t\tlocation={latlng}\r\n\t\t\t\tmarkerDrag={(marker) => markerDrag(marker)}\r\n\t\t\t/>\r\n\r\n\t\t\t<Box flexBox justifyContent=\"space-between\" mt={40}>\r\n\t\t\t\t<Button\r\n\t\t\t\t\ttitle=\"Save\"\r\n\t\t\t\t\ticonPosition=\"left\"\r\n\t\t\t\t\ticon={<Icon icon={archive} size={18} color=\"#8C8C8C\" />}\r\n\t\t\t\t\tonClick={handleDraftingPost}\r\n\t\t\t\t\tvariant=\"textButton\"\r\n\t\t\t\t\tisLoading={btnLoading}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button\r\n\t\t\t\t\ttitle=\"Previous\"\r\n\t\t\t\t\ticonPosition=\"left\"\r\n\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\ttype: \"UPDATE_STEP\",\r\n\t\t\t\t\t\t\tpayload: { step: step - 1 },\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdisabled={btnLoading}\r\n\t\t\t\t\ticon={<Icon icon={chevronLeft} size={14} color=\"#8C8C8C\" />}\r\n\t\t\t\t\tvariant=\"textButton\"\r\n\t\t\t\t\tmr={30}\r\n\t\t\t\t\tml=\"auto\"\r\n\t\t\t\t/>\r\n\t\t\t\t<Button\r\n\t\t\t\t\ttitle=\"Next\"\r\n\t\t\t\t\ticonPosition=\"right\"\r\n\t\t\t\t\tdisabled={adPost.location == null || btnLoading}\r\n\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\ttype: \"UPDATE_STEP\",\r\n\t\t\t\t\t\t\tpayload: { step: step + 1 },\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\ticon={<Icon icon={chevronRight} size={21} color=\"#ffffff\" />}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackgroundColor:\r\n\t\t\t\t\t\t\tadPost.location == null || btnLoading ? \"#e2e2e2\" : \"#30C56D\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</Box>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default LocationInfo;\r\n"]},"metadata":{},"sourceType":"module"}