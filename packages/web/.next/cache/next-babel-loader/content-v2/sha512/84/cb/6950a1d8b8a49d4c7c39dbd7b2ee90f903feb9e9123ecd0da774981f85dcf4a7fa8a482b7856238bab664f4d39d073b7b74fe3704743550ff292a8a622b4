{"ast":null,"code":"import _defineProperty from \"/Users/mrcea/Desktop/Nunua/template/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/mrcea/Desktop/Nunua/template/packages/web/pages/add-post/[id].js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect } from 'react';\nimport { Grid, Row, Col } from 'react-styled-flexboxgrid';\nimport { useRouter } from 'next/router';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Modal } from '@redq/reuse-modal';\nimport { GET_POST_FOR_EDIT } from 'core/graphql/Post.query';\nimport Alert from 'reusecore/src/elements/Alert';\nimport SecretPage from '../../hoc/secretPage';\nimport withLayout from '../../hoc/withLayout';\nimport { adPostSteps, STEPS, AddPostContext, AddPostProvider } from '../../contexts/AddPostContext';\nimport PageMeta from '../../components/PageMeta';\nimport PickImages from '../../containers/AddPost/PickImages';\nimport TitleAndPriceInfo from '../../containers/AddPost/TitleAndPriceInfo';\nimport CategoryAndDetailInfo from '../../containers/AddPost/CategoryAndDetailInfo';\nimport LocationInfo from '../../containers/AddPost/LocationInfo';\nimport ContactNumberInfo from '../../containers/AddPost/ContactNumberInfo';\nimport TopToolBar from '../../containers/AddPost/TopToolBar';\nimport AdImagesInfo from '../../containers/AddPost/AddImage';\nimport Progress from '../../components/Progress';\nimport { withApollo } from '../../helpers/apollo';\nvar counter = 0;\n\nvar AddPost = function AddPost(_ref) {\n  _s();\n\n  var isLoggedIn = _ref.isLoggedIn,\n      userId = _ref.userId,\n      email = _ref.email;\n\n  var _useContext = useContext(AddPostContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var step = state.step;\n\n  var _useRouter = useRouter(),\n      id = _useRouter.query.id;\n\n  if (id != 'new') {\n    var _useQuery = useQuery(GET_POST_FOR_EDIT, {\n      variables: {\n        id: id\n      }\n    }),\n        data = _useQuery.data,\n        loading = _useQuery.loading,\n        error = _useQuery.error;\n\n    useEffect(function () {\n      if (!loading && Object.keys(data).length) {\n        if (counter < 1) {\n          dispatch({\n            type: 'UPDATE_STEP',\n            payload: {\n              step: 1\n            }\n          });\n\n          if (id) {\n            dispatch({\n              type: 'UPDATE_FULL_ADPOST',\n              payload: {\n                id: id\n              }\n            });\n          }\n\n          var location = null;\n\n          if (data.post.formattedLocation && data.post.formattedLocation.lat) {\n            location = {\n              lat: data.post.formattedLocation && data.post.formattedLocation.lat,\n              lng: data.post.formattedLocation && data.post.formattedLocation.lng,\n              formattedAddress: data.post.formattedLocation && data.post.formattedLocation.formattedAddress ? data.post.formattedLocation.formattedAddress : '',\n              locationCategory: data.post.formattedLocation && data.post.formattedLocation.formattedAddress ? data.post.formattedLocation.locationCategory : ''\n            };\n          }\n\n          dispatch({\n            type: 'UPDATE_FULL_ADPOST',\n            payload: {\n              title: data.post.title,\n              condition: data.post.condition,\n              price: data.post.price,\n              image: data.post.image,\n              gallery: data.post.gallery,\n              isNegotiable: data.post.isNegotiable,\n              authorId: userId,\n              content: data.post.content,\n              status: data.post.status,\n              slug: data.post.slug,\n              location: location,\n              categories: data.post.categories,\n              contactNumber: data.post.contactNumber\n            }\n          });\n          counter++;\n        }\n      }\n\n      return function () {\n        null;\n      };\n    }, [data]); // Error Rendering.\n\n    if (error) return /*#__PURE__*/_jsxDEV(Alert, {\n      children: \"Error! \".concat(error.message)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 23\n    }, _this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: adPostSteps[step] && adPostSteps[step] === STEPS.STEP_CHOOSE_IMAGES ? /*#__PURE__*/_jsxDEV(PickImages, {\n      userId: userId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, _this) : /*#__PURE__*/_jsxDEV(Grid, {\n      style: {\n        paddingTop: '80px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          xs: 12,\n          sm: 12,\n          children: [/*#__PURE__*/_jsxDEV(TopToolBar, {\n            onClose: function onClose() {\n              return dispatch({\n                type: 'CANCEL_AD_POSTING'\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(Progress, {\n            color: \"#30c56d\",\n            progress: 1 / 4 * step,\n            height: 4,\n            style: {\n              marginBottom: '40px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          xs: 12,\n          sm: 7,\n          md: 7,\n          children: /*#__PURE__*/_jsxDEV(AdImagesInfo, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(Col, {\n          xs: 12,\n          sm: 5,\n          md: 5,\n          style: {\n            marginBottom: 50\n          },\n          children: [adPostSteps[step] && adPostSteps[step] === STEPS.STEP_SET_TITLE_AND_PRICE && /*#__PURE__*/_jsxDEV(TitleAndPriceInfo, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 19\n          }, _this), adPostSteps[step] && adPostSteps[step] === STEPS.STEP_SET_LOCATION && /*#__PURE__*/_jsxDEV(LocationInfo, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 19\n          }, _this), adPostSteps[step] && adPostSteps[step] === STEPS.STEP_SET_CATEGORY_AND_TAGS && /*#__PURE__*/_jsxDEV(CategoryAndDetailInfo, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 19\n          }, _this), adPostSteps[step] && adPostSteps[step] === STEPS.STEP_SET_CONTACT_NUMBER && /*#__PURE__*/_jsxDEV(ContactNumberInfo, {\n            userId: userId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 19\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, _this)\n  }, void 0, false);\n};\n\n_s(AddPost, \"xFn5npcRC3VO6XsQFyGvwePOG6Q=\", false, function () {\n  return [useRouter, useQuery];\n});\n\n_c = AddPost;\n\nfunction AdPostPage(props) {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(PageMeta, {\n      title: \"Add post\",\n      description: \"Add post\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddPostProvider, {\n      children: [/*#__PURE__*/_jsxDEV(AddPost, _objectSpread({}, props), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_c2 = AdPostPage;\nexport default _c5 = withApollo(_c4 = SecretPage(_c3 = withLayout(AdPostPage)));\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"AddPost\");\n$RefreshReg$(_c2, \"AdPostPage\");\n$RefreshReg$(_c3, \"%default%$withApollo$SecretPage\");\n$RefreshReg$(_c4, \"%default%$withApollo\");\n$RefreshReg$(_c5, \"%default%\");","map":{"version":3,"sources":["/Users/mrcea/Desktop/Nunua/template/packages/web/pages/add-post/[id].js"],"names":["useContext","useEffect","Grid","Row","Col","useRouter","useQuery","Modal","GET_POST_FOR_EDIT","Alert","SecretPage","withLayout","adPostSteps","STEPS","AddPostContext","AddPostProvider","PageMeta","PickImages","TitleAndPriceInfo","CategoryAndDetailInfo","LocationInfo","ContactNumberInfo","TopToolBar","AdImagesInfo","Progress","withApollo","counter","AddPost","isLoggedIn","userId","email","state","dispatch","step","id","query","variables","data","loading","error","Object","keys","length","type","payload","location","post","formattedLocation","lat","lng","formattedAddress","locationCategory","title","condition","price","image","gallery","isNegotiable","authorId","content","status","slug","categories","contactNumber","message","STEP_CHOOSE_IMAGES","paddingTop","marginBottom","STEP_SET_TITLE_AND_PRICE","STEP_SET_LOCATION","STEP_SET_CATEGORY_AND_TAGS","STEP_SET_CONTACT_NUMBER","AdPostPage","props"],"mappings":"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","sourcesContent":["import { useContext, useEffect } from 'react';\nimport { Grid, Row, Col } from 'react-styled-flexboxgrid';\nimport { useRouter } from 'next/router';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Modal } from '@redq/reuse-modal';\nimport { GET_POST_FOR_EDIT } from 'core/graphql/Post.query';\nimport Alert from 'reusecore/src/elements/Alert';\nimport SecretPage from '../../hoc/secretPage';\nimport withLayout from '../../hoc/withLayout';\nimport {\n  adPostSteps,\n  STEPS,\n  AddPostContext,\n  AddPostProvider,\n} from '../../contexts/AddPostContext';\nimport PageMeta from '../../components/PageMeta';\nimport PickImages from '../../containers/AddPost/PickImages';\nimport TitleAndPriceInfo from '../../containers/AddPost/TitleAndPriceInfo';\nimport CategoryAndDetailInfo from '../../containers/AddPost/CategoryAndDetailInfo';\nimport LocationInfo from '../../containers/AddPost/LocationInfo';\nimport ContactNumberInfo from '../../containers/AddPost/ContactNumberInfo';\nimport TopToolBar from '../../containers/AddPost/TopToolBar';\nimport AdImagesInfo from '../../containers/AddPost/AddImage';\n\nimport Progress from '../../components/Progress';\nimport { withApollo } from '../../helpers/apollo';\nlet counter = 0;\nconst AddPost = ({ isLoggedIn, userId, email }) => {\n  const { state, dispatch } = useContext(AddPostContext);\n  const { step } = state;\n  const {\n    query: { id },\n  } = useRouter();\n  if (id != 'new') {\n    const { data, loading, error } = useQuery(GET_POST_FOR_EDIT, {\n      variables: { id },\n    });\n    useEffect(() => {\n      if (!loading && Object.keys(data).length) {\n        if (counter < 1) {\n          dispatch({\n            type: 'UPDATE_STEP',\n            payload: { step: 1 },\n          });\n          if (id) {\n            dispatch({\n              type: 'UPDATE_FULL_ADPOST',\n              payload: { id: id },\n            });\n          }\n          let location = null;\n          if (data.post.formattedLocation && data.post.formattedLocation.lat) {\n            location = {\n              lat:\n                data.post.formattedLocation && data.post.formattedLocation.lat,\n              lng:\n                data.post.formattedLocation && data.post.formattedLocation.lng,\n              formattedAddress:\n                data.post.formattedLocation &&\n                data.post.formattedLocation.formattedAddress\n                  ? data.post.formattedLocation.formattedAddress\n                  : '',\n              locationCategory:\n              data.post.formattedLocation &&\n              data.post.formattedLocation.formattedAddress\n                ? data.post.formattedLocation.locationCategory\n                : '',\n            };\n          }\n\n          dispatch({\n            type: 'UPDATE_FULL_ADPOST',\n            payload: {\n              title: data.post.title,\n              condition: data.post.condition,\n              price: data.post.price,\n              image: data.post.image,\n              gallery: data.post.gallery,\n              isNegotiable: data.post.isNegotiable,\n              authorId: userId,\n              content: data.post.content,\n              status: data.post.status,\n              slug: data.post.slug,\n              location,\n              categories: data.post.categories,\n              contactNumber: data.post.contactNumber,\n            },\n          });\n          counter++;\n        }\n      }\n      return () => {\n        null;\n      };\n    }, [data]);\n\n    // Error Rendering.\n    if (error) return <Alert>{`Error! ${error.message}`}</Alert>;\n  }\n\n  return (\n    <>\n      {adPostSteps[step] && adPostSteps[step] === STEPS.STEP_CHOOSE_IMAGES ? (\n        <PickImages userId={userId} />\n      ) : (\n        <Grid\n          style={{\n            paddingTop: '80px',\n          }}\n        >\n          <Row>\n            <Col xs={12} sm={12}>\n              <TopToolBar\n                onClose={() => dispatch({ type: 'CANCEL_AD_POSTING' })}\n              />\n              <Progress\n                color=\"#30c56d\"\n                progress={(1 / 4) * step}\n                height={4}\n                style={{ marginBottom: '40px' }}\n              />\n            </Col>\n          </Row>\n          <Row>\n            <Col xs={12} sm={7} md={7}>\n              <AdImagesInfo />\n            </Col>\n            <Col xs={12} sm={5} md={5} style={{ marginBottom: 50 }}>\n              {adPostSteps[step] &&\n                adPostSteps[step] === STEPS.STEP_SET_TITLE_AND_PRICE && (\n                  <TitleAndPriceInfo />\n                )}\n              {adPostSteps[step] &&\n                adPostSteps[step] === STEPS.STEP_SET_LOCATION && (\n                  <LocationInfo />\n                )}\n              {adPostSteps[step] &&\n                adPostSteps[step] === STEPS.STEP_SET_CATEGORY_AND_TAGS && (\n                  <CategoryAndDetailInfo />\n                )}\n              {adPostSteps[step] &&\n                adPostSteps[step] === STEPS.STEP_SET_CONTACT_NUMBER && (\n                  <ContactNumberInfo userId={userId} />\n                )}\n            </Col>\n          </Row>\n        </Grid>\n      )}\n    </>\n  );\n};\n\nfunction AdPostPage(props) {\n  return (\n    <>\n      <PageMeta title=\"Add post\" description=\"Add post\" />\n      <AddPostProvider>\n        <AddPost {...props} />\n        <Modal />\n      </AddPostProvider>\n    </>\n  );\n}\n\nexport default withApollo(SecretPage(withLayout(AdPostPage)));\n"]},"metadata":{},"sourceType":"module"}