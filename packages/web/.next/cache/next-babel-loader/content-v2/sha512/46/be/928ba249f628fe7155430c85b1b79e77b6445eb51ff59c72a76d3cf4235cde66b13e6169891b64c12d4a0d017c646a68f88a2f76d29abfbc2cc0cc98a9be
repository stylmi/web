{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _objectWithoutProperties from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\olaji\\\\OneDrive\\\\Documents\\\\sellit\\\\template\\\\packages\\\\web\\\\containers\\\\AddPost\\\\ContactNumberInfo\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query GetAuthorMobile($username: ID!) {\\n    author(id: $username) {\\n      id\\n      mobile {\\n        number\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport Icon from 'react-icons-kit';\nimport { chevronRight } from 'react-icons-kit/ionicons/chevronRight';\nimport { chevronLeft } from 'react-icons-kit/ionicons/chevronLeft';\nimport { uploadMultipleImages } from '../../../helpers/uploadMultipleImage';\nimport Box from '../../../../reusecore/src/elements/Box';\nimport Button from '../../../../reusecore/src/elements/Button';\nimport Text from '../../../../reusecore/src/elements/Text';\nimport Dropdown from '../../../components/DropdownSelect';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { ADD_POST } from '../../../../core/graphql/Mutations';\nimport { openModal, closeModal } from '@redq/reuse-modal';\nimport PublishModal from '../../ModalContainer/PostPublishModal';\nimport AuthHelper from '../../../helpers/authHelper';\nimport Link from 'next/link';\nimport { ACCOUNT_SETTING_PAGE } from '../../../../core/navigation/constant';\nimport { AddPostContext } from '../../../contexts/AddPostContext';\nimport gql from 'graphql-tag';\nvar GET_AUTHOR_MOBILE_NUMBER = gql(_templateObject());\n\nvar publishModal = function publishModal(newPost) {\n  if (newPost && newPost.data && newPost.data.addPost && newPost.data.addPost.status === 'publish') {\n    openModal({\n      config: {\n        disableDragging: false,\n        size: {\n          width: 360,\n          height: 320\n        },\n        enableResizing: {\n          bottom: true,\n          bottomLeft: true,\n          bottomRight: true,\n          left: true,\n          right: true,\n          top: true,\n          topLeft: true,\n          topRight: true\n        }\n      },\n      closeOnClickOutside: true,\n      component: PublishModal,\n      componentProps: {\n        data: {\n          closeModal: closeModal,\n          title: 'Congrats!!!',\n          message: 'Your account information saved successfully',\n          slug: newPost.data.addPost.slug\n        }\n      }\n    });\n  }\n};\n\nvar imagesUrl = [];\n\nvar ContactNumberInfo = function ContactNumberInfo(_ref) {\n  _s();\n\n  var userId = _ref.userId;\n\n  var _useQuery = useQuery(GET_AUTHOR_MOBILE_NUMBER, {\n    variables: {\n      username: userId\n    }\n  }),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error;\n\n  var _useContext = useContext(AddPostContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var _useState = useState(false),\n      btnLoading = _useState[0],\n      setBtnLoading = _useState[1];\n\n  var _useState2 = useState(false),\n      publishBtnLoading = _useState2[0],\n      setPublishBtnLoading = _useState2[1];\n\n  var step = state.step,\n      adPost = state.adPost;\n\n  var _useMutation = useMutation(ADD_POST),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      postMutation = _useMutation2[0];\n\n  var handlePostSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return AuthHelper.refreshToken();\n\n            case 2:\n              setPublishBtnLoading(true);\n              dispatch({\n                type: 'UPDATE_ADPOST',\n                payload: {\n                  key: 'status',\n                  value: 'publish'\n                }\n              });\n\n              if (!adPost.localGallery.length) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 7;\n              return uploadMultipleImages(adPost.localGallery);\n\n            case 7:\n              imagesUrl = _context.sent;\n\n              if (imagesUrl && imagesUrl.length > 0) {\n                dispatch({\n                  type: 'UPDATE_FULL_ADPOST',\n                  payload: {\n                    gallery: adPost.gallery.concat(imagesUrl[0]),\n                    image: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\n                    localImage: {},\n                    localGallery: []\n                  }\n                });\n              }\n\n              _context.next = 24;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.next = 14;\n              return postMutation({\n                variables: {\n                  post: _objectSpread(_objectSpread({}, finalData), {}, {\n                    status: 'publish'\n                  })\n                }\n              });\n\n            case 14:\n              _data = _context.sent;\n              setPublishBtnLoading(false);\n\n              if (!adPost.id) {\n                dispatch({\n                  type: 'UPDATE_ADPOST',\n                  payload: {\n                    key: 'id',\n                    value: _data.data.addPost.id\n                  }\n                });\n              }\n\n              publishModal(_data);\n              _context.next = 24;\n              break;\n\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](11);\n              console.log(_context.t0, 'error');\n              setPublishBtnLoading(false);\n\n            case 24:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[11, 20]]);\n    }));\n\n    return function handlePostSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var preImage = adPost.preImage,\n      preGallery = adPost.preGallery,\n      localImage = adPost.localImage,\n      localGallery = adPost.localGallery,\n      location = adPost.location,\n      prossedAdPostData = _objectWithoutProperties(adPost, [\"preImage\", \"preGallery\", \"localImage\", \"localGallery\", \"location\"]);\n\n  var finalData = prossedAdPostData;\n\n  if (location && location.lat) {\n    finalData = _objectSpread(_objectSpread({}, prossedAdPostData), {}, {\n      location: location\n    });\n  }\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _data2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!imagesUrl.length) {\n                _context2.next = 15;\n                break;\n              }\n\n              _context2.prev = 1;\n              _context2.next = 4;\n              return postMutation({\n                variables: {\n                  post: _objectSpread(_objectSpread({}, finalData), {}, {\n                    status: 'publish'\n                  })\n                }\n              });\n\n            case 4:\n              _data2 = _context2.sent;\n              setPublishBtnLoading(false);\n              setBtnLoading(false);\n\n              if (!adPost.id) {\n                dispatch({\n                  type: 'UPDATE_ADPOST',\n                  payload: {\n                    key: 'id',\n                    value: _data2.data.addPost.id\n                  }\n                });\n              }\n\n              publishModal(_data2);\n              _context2.next = 15;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](1);\n              setPublishBtnLoading(false);\n              setBtnLoading(false);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 11]]);\n    }))();\n  }, [prossedAdPostData.gallery]);\n  var mobiles = [];\n\n  if (!loading && data.author && data.author.mobile && data.author.mobile.length) {\n    data.author.mobile.map(function (mobile) {\n      mobiles.push({\n        value: mobile.number,\n        label: mobile.number\n      });\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      content: \"Select the mobile number you want as contact\",\n      pb: 20,\n      style: {\n        fontSize: 16,\n        fontWeight: 400,\n        color: '#595959'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, _this), !mobiles.length && !loading ? /*#__PURE__*/_jsxDEV(Link, {\n      href: \"\".concat(ACCOUNT_SETTING_PAGE, \"?view=add-mobile-number\"),\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        title: \"Add Mobile Number Now\",\n        variant: \"textButton\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }, _this) : null, mobiles.length && !loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        content: \"Select Your Mobile Number\",\n        style: {\n          fontSize: 16,\n          fontWeight: 400,\n          color: '#595959'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(Dropdown, {\n        options: mobiles,\n        value: {\n          label: adPost.contactNumber,\n          value: adPost.contactNumber\n        },\n        onChange: function onChange(contact, index, options) {\n          dispatch({\n            type: 'UPDATE_ADPOST',\n            payload: {\n              key: 'contactNumber',\n              value: contact.value\n            }\n          });\n        },\n        placeholder: \"Contact Number\",\n        label: \"Contact Number\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true) : null, /*#__PURE__*/_jsxDEV(Box, {\n      flexBox: true,\n      justifyContent: \"space-between\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        title: \"Previous\",\n        iconPosition: \"left\",\n        onClick: function onClick() {\n          return dispatch({\n            type: 'UPDATE_STEP',\n            payload: {\n              step: step - 1\n            }\n          });\n        },\n        disabled: btnLoading,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          icon: chevronLeft,\n          size: 14,\n          color: \"#8C8C8C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }, _this),\n        variant: \"textButton\",\n        mr: 30,\n        ml: \"auto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Button, {\n        title: \"Done\",\n        iconPosition: \"right\",\n        disabled: adPost.contactNumber.length === 0 || btnLoading,\n        isLoading: publishBtnLoading,\n        loaderColor: \"#ffffff\",\n        onClick: handlePostSubmit,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          icon: chevronRight,\n          size: 21,\n          color: \"#ffffff\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 17\n        }, _this),\n        style: {\n          backgroundColor: adPost.contactNumber.length === 0 || btnLoading ? '#d2d2d2' : '#30C56D'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(ContactNumberInfo, \"AL0SbNLt/gePE+aOP6b1ntWSmAs=\", false, function () {\n  return [useQuery, useMutation];\n});\n\n_c = ContactNumberInfo;\nexport default ContactNumberInfo;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContactNumberInfo\");","map":{"version":3,"sources":["C:/Users/olaji/OneDrive/Documents/sellit/template/packages/web/containers/AddPost/ContactNumberInfo/index.js"],"names":["React","useContext","useEffect","useState","Icon","chevronRight","chevronLeft","uploadMultipleImages","Box","Button","Text","Dropdown","useMutation","useQuery","ADD_POST","openModal","closeModal","PublishModal","AuthHelper","Link","ACCOUNT_SETTING_PAGE","AddPostContext","gql","GET_AUTHOR_MOBILE_NUMBER","publishModal","newPost","data","addPost","status","config","disableDragging","size","width","height","enableResizing","bottom","bottomLeft","bottomRight","left","right","top","topLeft","topRight","closeOnClickOutside","component","componentProps","title","message","slug","imagesUrl","ContactNumberInfo","userId","variables","username","loading","error","state","dispatch","btnLoading","setBtnLoading","publishBtnLoading","setPublishBtnLoading","step","adPost","postMutation","handlePostSubmit","refreshToken","type","payload","key","value","localGallery","length","gallery","concat","image","url","localImage","post","finalData","id","console","log","preImage","preGallery","location","prossedAdPostData","lat","mobiles","author","mobile","map","push","number","label","fontSize","fontWeight","color","contactNumber","contact","index","options","backgroundColor"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport Icon from 'react-icons-kit';\r\nimport { chevronRight } from 'react-icons-kit/ionicons/chevronRight';\r\nimport { chevronLeft } from 'react-icons-kit/ionicons/chevronLeft';\r\nimport { uploadMultipleImages } from '../../../helpers/uploadMultipleImage';\r\nimport Box from '../../../../reusecore/src/elements/Box';\r\nimport Button from '../../../../reusecore/src/elements/Button';\r\nimport Text from '../../../../reusecore/src/elements/Text';\r\nimport Dropdown from '../../../components/DropdownSelect';\r\nimport { useMutation, useQuery } from '@apollo/react-hooks';\r\nimport { ADD_POST } from '../../../../core/graphql/Mutations';\r\nimport { openModal, closeModal } from '@redq/reuse-modal';\r\nimport PublishModal from '../../ModalContainer/PostPublishModal';\r\nimport AuthHelper from '../../../helpers/authHelper';\r\nimport Link from 'next/link';\r\nimport { ACCOUNT_SETTING_PAGE } from '../../../../core/navigation/constant';\r\nimport { AddPostContext } from '../../../contexts/AddPostContext';\r\nimport gql from 'graphql-tag';\r\n\r\nconst GET_AUTHOR_MOBILE_NUMBER = gql`\r\n  query GetAuthorMobile($username: ID!) {\r\n    author(id: $username) {\r\n      id\r\n      mobile {\r\n        number\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst publishModal = newPost => {\r\n  if (\r\n    newPost &&\r\n    newPost.data &&\r\n    newPost.data.addPost &&\r\n    newPost.data.addPost.status === 'publish'\r\n  ) {\r\n    openModal({\r\n      config: {\r\n        disableDragging: false,\r\n        size: {\r\n          width: 360,\r\n          height: 320,\r\n        },\r\n        enableResizing: {\r\n          bottom: true,\r\n          bottomLeft: true,\r\n          bottomRight: true,\r\n          left: true,\r\n          right: true,\r\n          top: true,\r\n          topLeft: true,\r\n          topRight: true,\r\n        },\r\n      },\r\n      closeOnClickOutside: true,\r\n      component: PublishModal,\r\n      componentProps: {\r\n        data: {\r\n          closeModal,\r\n          title: 'Congrats!!!',\r\n          message: 'Your account information saved successfully',\r\n          slug: newPost.data.addPost.slug,\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\nlet imagesUrl = [];\r\nconst ContactNumberInfo = ({ userId }) => {\r\n  const { data, loading, error } = useQuery(GET_AUTHOR_MOBILE_NUMBER, {\r\n    variables: { username: userId },\r\n  });\r\n  const { state, dispatch } = useContext(AddPostContext);\r\n  const [btnLoading, setBtnLoading] = useState(false);\r\n  const [publishBtnLoading, setPublishBtnLoading] = useState(false);\r\n  const { step, adPost } = state;\r\n  const [postMutation] = useMutation(ADD_POST);\r\n\r\n  const handlePostSubmit = async () => {\r\n    await AuthHelper.refreshToken();\r\n    setPublishBtnLoading(true);\r\n    dispatch({\r\n      type: 'UPDATE_ADPOST',\r\n      payload: { key: 'status', value: 'publish' },\r\n    });\r\n    if (adPost.localGallery.length) {\r\n      imagesUrl = await uploadMultipleImages(adPost.localGallery);\r\n      if (imagesUrl && imagesUrl.length > 0) {\r\n        dispatch({\r\n          type: 'UPDATE_FULL_ADPOST',\r\n          payload: {\r\n            gallery: adPost.gallery.concat(imagesUrl[0]),\r\n            image: !adPost.image.url ? imagesUrl[0][0] : adPost.image,\r\n            localImage: {},\r\n            localGallery: [],\r\n          },\r\n        });\r\n      }\r\n    } else {\r\n      try {\r\n        const data = await postMutation({\r\n          variables: {\r\n            post: { ...finalData, status: 'publish' },\r\n          },\r\n        });\r\n        setPublishBtnLoading(false);\r\n        if (!adPost.id) {\r\n          dispatch({\r\n            type: 'UPDATE_ADPOST',\r\n            payload: { key: 'id', value: data.data.addPost.id },\r\n          });\r\n        }\r\n        publishModal(data);\r\n      } catch (error) {\r\n        console.log(error, 'error');\r\n        setPublishBtnLoading(false);\r\n      }\r\n    }\r\n  };\r\n  const {\r\n    preImage,\r\n    preGallery,\r\n    localImage,\r\n    localGallery,\r\n    location,\r\n    ...prossedAdPostData\r\n  } = adPost;\r\n  let finalData = prossedAdPostData;\r\n  if (location && location.lat) {\r\n    finalData = {\r\n      ...prossedAdPostData,\r\n      location,\r\n    };\r\n  }\r\n\r\n  useEffect(() => {\r\n    (async function() {\r\n      if (imagesUrl.length) {\r\n        try {\r\n          const data = await postMutation({\r\n            variables: {\r\n              post: { ...finalData, status: 'publish' },\r\n            },\r\n          });\r\n          setPublishBtnLoading(false);\r\n          setBtnLoading(false);\r\n          if (!adPost.id) {\r\n            dispatch({\r\n              type: 'UPDATE_ADPOST',\r\n              payload: { key: 'id', value: data.data.addPost.id },\r\n            });\r\n          }\r\n          publishModal(data);\r\n        } catch (error) {\r\n          setPublishBtnLoading(false);\r\n          setBtnLoading(false);\r\n        }\r\n      }\r\n    })();\r\n  }, [prossedAdPostData.gallery]);\r\n\r\n  let mobiles = [];\r\n  if (\r\n    !loading &&\r\n    data.author &&\r\n    data.author.mobile &&\r\n    data.author.mobile.length\r\n  ) {\r\n    data.author.mobile.map(mobile => {\r\n      mobiles.push({\r\n        value: mobile.number,\r\n        label: mobile.number,\r\n      });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Text\r\n        content=\"Select the mobile number you want as contact\"\r\n        pb={20}\r\n        style={{ fontSize: 16, fontWeight: 400, color: '#595959' }}\r\n      />\r\n      {!mobiles.length && !loading ? (\r\n        <Link href={`${ACCOUNT_SETTING_PAGE}?view=add-mobile-number`}>\r\n          <Button title=\"Add Mobile Number Now\" variant=\"textButton\" />\r\n        </Link>\r\n      ) : null}\r\n      {mobiles.length && !loading ? (\r\n        <>\r\n          <Text\r\n            content=\"Select Your Mobile Number\"\r\n            style={{ fontSize: 16, fontWeight: 400, color: '#595959' }}\r\n          />\r\n          <Dropdown\r\n            options={mobiles}\r\n            value={{ label: adPost.contactNumber, value: adPost.contactNumber }}\r\n            onChange={(contact, index, options) => {\r\n              dispatch({\r\n                type: 'UPDATE_ADPOST',\r\n                payload: { key: 'contactNumber', value: contact.value },\r\n              });\r\n            }}\r\n            placeholder=\"Contact Number\"\r\n            label=\"Contact Number\"\r\n          />\r\n        </>\r\n      ) : null}\r\n\r\n      <Box flexBox justifyContent=\"space-between\">\r\n        <Button\r\n          title=\"Previous\"\r\n          iconPosition=\"left\"\r\n          onClick={() =>\r\n            dispatch({\r\n              type: 'UPDATE_STEP',\r\n              payload: { step: step - 1 },\r\n            })\r\n          }\r\n          disabled={btnLoading}\r\n          icon={<Icon icon={chevronLeft} size={14} color=\"#8C8C8C\" />}\r\n          variant=\"textButton\"\r\n          mr={30}\r\n          ml=\"auto\"\r\n        />\r\n        <Button\r\n          title=\"Done\"\r\n          iconPosition=\"right\"\r\n          disabled={adPost.contactNumber.length === 0 || btnLoading}\r\n          isLoading={publishBtnLoading}\r\n          loaderColor=\"#ffffff\"\r\n          onClick={handlePostSubmit}\r\n          icon={<Icon icon={chevronRight} size={21} color=\"#ffffff\" />}\r\n          style={{\r\n            backgroundColor:\r\n              adPost.contactNumber.length === 0 || btnLoading\r\n                ? '#d2d2d2'\r\n                : '#30C56D',\r\n          }}\r\n        />\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ContactNumberInfo;\r\n"]},"metadata":{},"sourceType":"module"}